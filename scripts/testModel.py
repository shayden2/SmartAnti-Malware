from sklearn import svm
from sklearn.metrics import accuracy_score
from joblib import load

from statistics import mean, stdev
from sklearn.model_selection import cross_val_score

import csv

def main():
    bitmaps = list()
    labels  = list()
    with open('../outputs/test_bitmaps.csv', 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            try:
                labels.append(row[1])
                bitmaps.append(list(row[2]))
            except:
                pass

    clf = load('../data/av-model.joblib')
    predictions = clf.predict(bitmaps)
    acc = accuracy_score(labels, predictions)

    bWrong = wWrong = 0
    for i in range(len(predictions)):
        if labels[i] == 'Blacklist' and predictions[i] == 'Whitelist':
            bWrong += 1
        elif labels[i] == 'Whitelist' and predictions[i] == 'Blacklist':
            wWrong += 1
    print(bWrong)
    print(wWrong)
    
    

if __name__ == '__main__':
    main()