from sklearn import svm
from sklearn.metrics import accuracy_score
from joblib import load
import csv

def main():
    bitmaps = list()
    labels  = list()
    with open('../outputs/test_bitmaps.csv', 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            try:
                labels.append(row[1])
                bitmaps.append(list(row[2]))
            except:
                pass

    clf = load('../data/av-model.joblib')
    predictions = clf.predict(bitmaps)
    acc = accuracy_score(labels, predictions)
    print(acc)
    

if __name__ == '__main__':
    main()