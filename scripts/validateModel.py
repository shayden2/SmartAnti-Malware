import csv
import numpy as np
from sklearn import svm
import sklearn
from sklearn.model_selection import KFold, cross_val_score
from sklearn.metrics import accuracy_score
from statistics import mean, stdev

def main():
    bitmaps = list()
    labels = list()
    with open('../outputs/train_bitmaps.csv', 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            try:
                t = row[1]
                bitmap = list(row[2])
                bitmaps.append(bitmap)
                labels.append(t)
            except:
                pass
    with open('../outputs/test_bitmaps.csv', 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            try:
                t = row[1]
                bitmap = list(row[2])
                bitmaps.append(bitmap)
                labels.append(t)
            except:
                pass
    
    clf = svm.SVC(kernel='rbf', C=1, random_state=42)
    scores = cross_val_score(clf, bitmaps, labels, cv=5)
    print(f'Mean: {scores.mean()}  Stdev: {scores.std()}')

if __name__ == '__main__':
    main()