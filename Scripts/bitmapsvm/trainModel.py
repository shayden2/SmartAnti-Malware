from sklearn import svm
from joblib import dump
import csv

def main():
    bitmaps = list()
    labels  = list()
    with open('../outputs/train_bitmaps.csv', 'r') as f:
        reader = csv.reader(f)
        for row in reader:
            try:
                labels.append(row[1])
                bitmaps.append(list(row[2]))
            except:
                pass
    
    clf = svm.SVC(kernel='rbf', C=1, random_state=42)
    clf.fit(bitmaps, labels)
    dump(clf, '../data/av-model.joblib')

if __name__ == '__main__':
    main()